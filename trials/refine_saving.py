import re
import pandas as pd

data = [
  '[Apple 2024 MacBook Pro Laptop with M4 chip with 10‑core CPU and 10‑core GPU: Built for Apple Intelligence, 35.97 cm (14.2″) Liquid Retina XDR Display, 16GB Unified Memory, 512GB SSD Storage; Silver](https://www.amazon.in/Apple-2024-MacBook-Laptop-10%E2%80%91core/dp/B0DLHNB9MY/ref=sr_1_3?dib=eyJ2IjoiMSJ9.E-2YqC-rMXASFzgAR1heGjWkK8zRFOg_CMlWfVStDP0_LGs9cubYIUWsy5ZmsrnE58iVfeUo5ID6yGoTt-7Rxbb9SzSXmKQMcZokWkviqkGOi8Lfed8RCGvakyY6Xmd3nKI5-cN2c-ElSVAjQpZv6Op44l9z5ekpxzTMzg_GjNICv5g5EnQdxcfzJGokNDTayDTt0ugyx8VL1rcnGfBtSDki-qn7gq4TBtQAtVIo5VM.DH6f-ztNfJS4I9O47cm51yLx2POZcnRxSjlj110exzI&dib_tag=se&keywords=MacBook+Pro+M4+chip+16GB+RAM&qid=1752043660&sr=8-3)",162990,,'
  '[Lenovo Smartchoice Ideapad Slim 3 13Th Gen Intel Core I7-13620H 15.3 Inch(38.8Cm) WUXGA IPS Laptop(16GB RAM/512GB SSD/Windows 11/Office Home 2024/Backlit Keyboard/1Yr ADP Free/Grey/1.6Kg),83K100CJIN](https://www.amazon.in/sspa/click?ie=UTF8&spc=MTo0MzMzMDA2NTk3ODgzNTgwOjE3NTIwNDM2NjA6c3Bfc2VhcmNoX3RoZW1hdGljOjMwMDU0OTU4MDUwNTYzMjo6Mjo6&url=%2FLenovo-Smartchoice-I7-13620H-Keyboard-83K100CJIN%2Fdp%2FB0F2162VGQ%2Fref%3Dsxin_15_pa_sp_search_thematic_sspa%3Fcontent-id%3Damzn1.sym.739e670d-dfb3-4be0-9815-d8c5c0372e07%253Aamzn1.sym.739e670d-dfb3-4be0-9815-d8c5c0372e07%26cv_ct_cx%3DMacBook%2BPro%2BM4%2Bchip%2B16GB%2BRAM%26keywords%3DMacBook%2BPro%2BM4%2Bchip%2B16GB%2BRAM%26pd_rd_i%3DB0F2162VGQ%26pd_rd_r%3Dbac15e69-1ef5-4caa-add1-6aa9445cb6e2%26pd_rd_w%3Dt09Hu%26pd_rd_wg%3DdamTy%26pf_rd_p%3D739e670d-dfb3-4be0-9815-d8c5c0372e07%26pf_rd_r%3DHQY1Y3F12JXSZA7A5WBQ%26qid%3D1752043660%26sbo%3DRZvfv%252F%252FHxDF%252BO5021pAnSA%253D%253D%26sr%3D1-2-66673dcf-083f-43ba-b782-d4a436cc5cfb-spons%26sp_csd%3Dd2lkZ2V0TmFtZT1zcF9zZWFyY2hfdGhlbWF0aWM%26psc%3D1&cr=DUB)",65990,,'
  '[Lenovo IdeaPad Pro 5 Intel Core Ultra 9 185H Built-in AI 14"" (35.5cm) 2.8K OLED 400Nits 120Hz Laptop (32GB RAM/1TB SSD/Windows 11/Office Home 2024/1Yr ADP Free/Grey/1.46Kg), 83D2004XIN](https://www.amazon.in/sspa/click?ie=UTF8&spc=MTo0MzMzMDA2NTk3ODgzNTgwOjE3NTIwNDM2NjA6c3Bfc2VhcmNoX3RoZW1hdGljOjMwMDU0OTc2ODQ2NTczMjo6Mzo6&url=%2FLenovo-IdeaPad-400Nits-Windows-83D2004XIN%2Fdp%2FB0F1N18XWV%2Fref%3Dsxin_15_pa_sp_search_thematic_sspa%3Fcontent-id%3Damzn1.sym.739e670d-dfb3-4be0-9815-d8c5c0372e07%253Aamzn1.sym.739e670d-dfb3-4be0-9815-d8c5c0372e07%26cv_ct_cx%3DMacBook%2BPro%2BM4%2Bchip%2B16GB%2BRAM%26keywords%3DMacBook%2BPro%2BM4%2Bchip%2B16GB%2BRAM%26pd_rd_i%3DB0F1N18XWV%26pd_rd_r%3Dbac15e69-1ef5-4caa-add1-6aa9445cb6e2%26pd_rd_w%3Dt09Hu%26pd_rd_wg%3DdamTy%26pf_rd_p%3D739e670d-dfb3-4be0-9815-d8c5c0372e07%26pf_rd_r%3DHQY1Y3F12JXSZA7A5WBQ%26qid%3D1752043660%26sbo%3DRZvfv%252F%252FHxDF%252BO5021pAnSA%253D%253D%26sr%3D1-3-66673dcf-083f-43ba-b782-d4a436cc5cfb-spons%26sp_csd%3Dd2lkZ2V0TmFtZT1zcF9zZWFyY2hfdGhlbWF0aWM%26psc%3D1&cr=DUB)",110990,,'
  '[Lenovo LOQ 2024, AMD Ryzen 5 7235HS, NVIDIA RTX 3050-6GB, 12GB RAM, 512GB SSD, FHD IPS 144Hz 300Nits, 15.6""/39.6cm, Windows 11, MS Office 21, Grey, 2.4Kg, 83JC0031IN, 3 Mon. Game Pass Gaming Laptop](https://www.amazon.in/sspa/click?ie=UTF8&spc=MTo0MzMzMDA2NTk3ODgzNTgwOjE3NTIwNDM2NjA6c3Bfc2VhcmNoX3RoZW1hdGljOjMwMDQxNzc2OTQ2NjQzMjo6NDo6&url=%2FLenovo-7235HS-300Nits-Graphics-83JC0031IN%2Fdp%2FB0D7VMYDJY%2Fref%3Dsxin_15_pa_sp_search_thematic_sspa%3Fcontent-id%3Damzn1.sym.739e670d-dfb3-4be0-9815-d8c5c0372e07%253Aamzn1.sym.739e670d-dfb3-4be0-9815-d8c5c0372e07%26cv_ct_cx%3DMacBook%2BPro%2BM4%2Bchip%2B16GB%2BRAM%26keywords%3DMacBook%2BPro%2BM4%2Bchip%2B16GB%2BRAM%26pd_rd_i%3DB0D7VMYDJY%26pd_rd_r%3Dbac15e69-1ef5-4caa-add1-6aa9445cb6e2%26pd_rd_w%3Dt09Hu%26pd_rd_wg%3DdamTy%26pf_rd_p%3D739e670d-dfb3-4be0-9815-d8c5c0372e07%26pf_rd_r%3DHQY1Y3F12JXSZA7A5WBQ%26qid%3D1752043660%26sbo%3DRZvfv%252F%252FHxDF%252BO5021pAnSA%253D%253D%26sr%3D1-4-66673dcf-083f-43ba-b782-d4a436cc5cfb-spons%26sp_csd%3Dd2lkZ2V0TmFtZT1zcF9zZWFyY2hfdGhlbWF0aWM%26psc%3D1&cr=DUB)",64990,,'
  '[Apple 2025 MacBook Air (13-inch, Apple M4 chip with 10-core CPU and 8-core GPU, 16GB Unified Memory, 256GB) - Midnight](https://www.amazon.in/Apple-MacBook-13-inch-10-core-Unified/dp/B0DZDDV7GC/ref=sr_1_5?dib=eyJ2IjoiMSJ9.E-2YqC-rMXASFzgAR1heGjWkK8zRFOg_CMlWfVStDP0_LGs9cubYIUWsy5ZmsrnE58iVfeUo5ID6yGoTt-7Rxbb9SzSXmKQMcZokWkviqkGOi8Lfed8RCGvakyY6Xmd3nKI5-cN2c-ElSVAjQpZv6Op44l9z5ekpxzTMzg_GjNICv5g5EnQdxcfzJGokNDTayDTt0ugyx8VL1rcnGfBtSDki-qn7gq4TBtQAtVIo5VM.DH6f-ztNfJS4I9O47cm51yLx2POZcnRxSjlj110exzI&dib_tag=se&keywords=MacBook+Pro+M4+chip+16GB+RAM&qid=1752043660&sr=8-5)",94990,,'
]

records = []
for line in data:
  match = re.match(r'\\[(.*?)\\]\\((.*?)\\)",?(\\d+)', line)
  if match:
    name = match.group(1).strip()
    link = match.group(2).strip()
    price = int(match.group(3))
    records.append({'Product Name': name, 'Link': link, 'Price (₹)': price})
  
  df = pd.DataFrame(records)
  df.to_excel('products.xlsx', index=False)